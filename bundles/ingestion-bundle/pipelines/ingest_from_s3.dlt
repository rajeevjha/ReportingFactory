import dlt
from pyspark.sql.functions import input_file_name

@dlt.table(name="raw_s3_reports")
def load_s3_reports():
    return (
        spark.read.format("csv")
        .option("header", "true")
        .load("s3://your-bucket-name/reports/sales/*.csv")
        .withColumn("source_file", input_file_name())
    )
